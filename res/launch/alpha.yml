type: launch
name: alpha
version: 0.2
#############################################################################
## EXECUTION ENGINES
##############################################################################

execution_engines:
  default:
    base_need: 2
    replicas: 4
    slots: 25
  service_gateway:
    base_need: 4
    config:
      unique_key: ddns_hostname
      unique_values: ${gateway_ddns_hosts}
    replicas: 1
    slots: 1

default_execution_engine: default

#############################################################################
#  APPS
#############################################################################

app_defaults:
  ha:
    policy: npreserving
    parameters:
      preserve_n: 4
      queueing_mode: START_ONLY

# apps included below override the app_defaults block. apps present in the REL
# but not below use the app_defaults block
apps:

  # bootstrap processes do not deploy with HA so we override the defaults
  bootstrapper1: {}
  bootstrapper2: {}
  parameter_bootstrap: {}
  policy_bootstrap: {}

  # scheduler needs an override block because it is a singleton and
  # may only have one deployed service process at a time.
  scheduler:
    ha:
        policy: npreserving
        parameters:
          preserve_n: 1
          queueing_mode: START_ONLY

  # gateway uses special engine
  service_gateway:
    ha:
      policy: npreserving
      parameters:
        preserve_n: 4
        queueing_mode: START_ONLY
        node_exclusive: service_gateway
        execution_engine_id: service_gateway
